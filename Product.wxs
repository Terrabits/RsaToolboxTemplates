<?xml version="1.0" encoding="UTF-8"?>
<!-- Installer template for use with Rsa Create Installer,
     part of the RsaToolbox. Do not modify unless you know
     what you are doing!!!                                -->


<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
     xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  
  <!-- Definition of my application -->
	<Product Id="*" Name="R&amp;S RsaToolbox For Qt 5" Language="1033" Version="0.2.1.0" Manufacturer="Rohde &amp; Schwarz America" UpgradeCode="9a6ea58e-fba9-4c5f-b3d4-02bd13a347e1">  
		
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<MediaTemplate  EmbedCab="yes" />
    <WixVariable Id="WixUILicenseRtf" Value="License.rtf" />
    <WixVariable Id="WixUIBannerBmp" Value="RS_Banner.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="RS_Dialog.bmp" />

    <Feature Id="RsaCreateInstaller" Level="1">
      <ComponentRef Id="RsaCreateInstallerComponent" />
      <ComponentRef Id="RSIB" />
      <ComponentRef Id="VC2010Runtime" />
      <ComponentRef Id="QtRuntime" />
      <ComponentRef Id="QtPlatformPlugin" />
    </Feature>
    <Feature Id="TutorialFeature" Level="1">
      <ComponentRef Id="TutorialComponent" />
      <ComponentRef Id="TutorialPart1Component" />
    </Feature>
    <Feature Id="TemplatesFeature" Level="1">
      <ComponentRef Id="TemplatesComponent" />
    </Feature>
    <Feature Id="License" Level="1">
      <ComponentRef Id="LicenseComponent" />
    </Feature>
    <Feature Id="Uninstaller" Level="1">
      <ComponentRef Id="UninstallShortcutComponent"/>
    </Feature>
    
    <Property Id="ARPPRODUCTICON" Value="RS.ico" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <UIRef Id="WixUI_InstallDir"/>
  </Product>

  <!-- Directory structure -->
  <Fragment>
    <!-- <SetDirectory Id="WINDOWSVOLUME" Value="[WindowsVolume]" /> -->
    <Directory Id="TARGETDIR" Name="SourceDir">
      <!-- <Directory Id="WINDOWSVOLUME"> -->
        <Directory Id="ProgramFilesFolder">
          <Directory Id="CompanyFilesFolder" Name="Rohde-Schwarz">
            <Directory Id="INSTALLFOLDER" Name="RsaToolbox For Qt 5">
              <Directory Id="RsaCreateInstallerFolder" Name="RSA Create Installer">
                <Directory Id="PlatformsFolder" Name="platforms" />
              </Directory>
              <Directory Id="TemplatesFolder" Name="RSA Qt Creator Templates" />
            </Directory>
          </Directory>
        </Directory>
        <Directory Id="ProgramMenuFolder">
          <Directory Id="ApplicationStartMenuFolder" Name="R&amp;S RsaToolbox For Qt 5" />
        </Directory>
        <Directory Id="CommonAppDataFolder">
          <Directory Id="CompanyDataFolder" Name="Rohde-Schwarz">
            <Directory Id="RsaToolboxDataFolder" Name="RsaToolbox For Qt 5">
              <Directory Id="SettingsFolder" Name="Settings" />
            </Directory>
          </Directory>
        </Directory>
      <!-- </Directory> -->
    </Directory>
  </Fragment>

  <!-- Application Components -->
  <Fragment>    
    <!-- Application files -->
    <Icon Id="RS.ico" SourceFile="RS.ico"/>
    <Component Id="RsaCreateInstallerComponent" Guid="694fd0f7-e646-48f3-922c-c8eaccab391d" Directory="RsaCreateInstallerFolder">
      <CreateFolder Directory="SettingsFolder" />
      <CreateFolder Directory="PlatformsFolder" />
      <File Id="AppExecutable" Name="RSA Create Installer 1.0.0.0.exe" Source="C:\Users\lalic\Documents\Qt\setup_wxs-build-Desktop_Qt_5_0_1_MSVC2010_32bit-Release\release\setup_wxs.exe" KeyPath="yes" />
      <RemoveFile Id="PurgeInstallFolder" Name="*.*" On="uninstall" />
      <RemoveFile Id="PurgePluginsFolder" Directory="PlatformsFolder" Name="*.*" On="uninstall" />
      <RemoveFile Id="PurgeAppDataFolder" Directory="RsaToolboxDataFolder" Name="*.*" On="uninstall" />
      <RemoveFile Id="PurgeSettingsFolder" Directory="SettingsFolder" Name="*.*" On="uninstall" />
      <RemoveFolder Id="RemoveSettingsFolder" Directory="SettingsFolder" On="uninstall" />
      <RemoveFolder Id="RemoveAppDataFolder" Directory="RsaToolboxDataFolder" On="uninstall" />
      <RemoveFolder Id="RemoveCompanyDataFolder" Directory="CompanyDataFolder" On="uninstall" />
      <RemoveFolder Id="RemoveAppStartMenuFolder" Directory="ApplicationStartMenuFolder" On="uninstall" />
      <RemoveFolder Id="RemoveInstallFolder" Directory="INSTALLFOLDER" On="uninstall" />
    </Component>
    <Component Id="RSIB" Guid="965b0380-3b94-40c9-a021-9b92cb69a15c" Directory="RsaCreateInstallerFolder">
      <File Id="rsib32.dll" Name="rsib32.dll" Source="..\RsaToolbox\rsib32.dll" KeyPath="yes"/>
    </Component>
    <Component Id="VC2010Runtime" Guid="7eaaadf9-420a-4ee8-ac9b-f93220c33c9e" Directory="RsaCreateInstallerFolder">
      <File Id="msvcr100.dll" Name="msvcr100.dll" Source="C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\redist\x86\Microsoft.VC100.CRT\msvcr100.dll" KeyPath="yes"/>
      <File Id="msvcp100.dll" Name="msvcp100.dll" Source="C:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\redist\x86\Microsoft.VC100.CRT\msvcp100.dll" />
    </Component>
    <Component Id="QtRuntime" Guid="25328d5b-c647-4572-9c5b-81e6cd896364" Directory="RsaCreateInstallerFolder">
      <File Id="Qt5Core.dll" Name="Qt5Core.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\Qt5Core.dll" KeyPath="yes" />
      <File Id="Qt5Gui.dll" Name="Qt5Gui.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\Qt5Gui.dll" />
      <File Id="Qt5Widgets.dll" Name="Qt5Widgets.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\Qt5Widgets.dll" />
      <File Id="libGLESv2.dll" Name="libGLESv2.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\libGLESv2.dll" />
      <File Id="libEGL.dll" Name="libEGL.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\libEGL.dll" />
      <File Id="D3DCompiler_43.dll" Name="D3DCompiler_43.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\D3DCompiler_43.dll" />
      <File Id="icudt49.dll" Name="icudt49.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\icudt49.dll" />
      <File Id="icuin49.dll" Name="icuin49.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\icuin49.dll" />
      <File Id="icuuc49.dll" Name="icuuc49.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\icuuc49.dll" />
    </Component>
    <Component Id="QtPlatformPlugin" Guid="26343c83-dcc3-424a-8356-deaad74d8b03" Directory="PlatformsFolder">
      <File Id="qwindows.dll" Name="qwindows.dll" Source="C:\Qt\Qt5.0.2\5.0.2\msvc2010\bin\..\plugins\platforms\qwindows.dll" KeyPath="yes" />
    </Component>
    <Component Id="TutorialComponent" Guid="75d1102a-584b-425f-a1c0-56f396082307" Directory="INSTALLFOLDER">
      <File Id="Tutorial" Name="RsaToolbox For Qt 5 Tutorial.pdf" Source="C:\Users\lalic\Google Drive\RSA\Software\Tutorials\VNA Qt Tutorial\RsaToolbox For Qt 5 Tutorial.pdf" KeyPath="yes">
        <Shortcut Id="TutorialShortcut" Name="RsaToolbox For Qt 5 Tutorial" Directory="ApplicationStartMenuFolder" Description="Create and deploy VNA automation applications with RsaToolbox" Advertise="yes" Icon="RS.ico" />
      </File>
    </Component>
    <Component Id="TutorialPart1Component" Guid="f7888715-2b92-4ec3-a9d3-a06762362135" Directory="INSTALLFOLDER">
      <File Id="Part1" Name="RsaDeleteCorrection.zip" Source="RsaDeleteCorrection.zip" KeyPath="yes">
        <Shortcut Id="Part1Shortcut" Name="RsaDeleteCorrection.zip" Directory="ApplicationStartMenuFolder" Description="Project from Part 1 of the tutorial" Advertise="yes" Icon="RS.ico" />
      </File>
    </Component>
    <Component Id="TemplatesComponent" Guid="74deeb9d-08cf-45a7-8edb-a095b7dac9e8" Directory="TemplatesFolder">
      <File Id="TemplateFiles" Name="RSA Qt Creator Templates v1.0.0.zip" Source="C:\Users\lalic\Documents\Qt\Deploy RsaToolbox\RSA Qt Creator Templates v1.0.0.zip" KeyPath="yes">
        <Shortcut Id="TemplateShortcut" Name="Qt Creator Templates" Directory="ApplicationStartMenuFolder" Description="Qt Creator template files to be copied to the Qt Creator wizards folder" Advertise="yes" Icon="RS.ico" />
      </File>
    </Component>
    <Component Id="LicenseComponent" Guid="b95ecd64-a0e8-47c6-825f-2fa3e79fd197" Directory="INSTALLFOLDER">
      <File Id="RSA_License" Name="License.txt" Source="License.txt" KeyPath="yes" />
    </Component>
    <Component Id="UninstallShortcutComponent" Guid="ea23ab9a-b668-4702-b4fd-ddec2f7157dc" Directory="ApplicationStartMenuFolder">
      <RegistryKey Root="HKCU" Key="Software\Rohde-Schwarz\RsaToolbox For Qt 5\Uninstall">
        <RegistryValue Value="Registry entry for RsaToolbox For Qt 5 uninstall shortcut" Type="string" KeyPath="yes" />
      </RegistryKey>
      <Shortcut Id="UninstallShortcut" Name="Uninstall" Target="[SystemFolder]msiexec.exe" Arguments="/x [ProductCode]" />
    </Component>
  </Fragment>
</Wix>